name: ğŸ”’ Node.js Security Scan

on:
  push:
    branches: ["main"]
  pull_request:
    branches: ["main"]

permissions:
  contents: read
  security-events: write
  actions: read

jobs:
  security-scan:
    name: ğŸ›¡ï¸ ÙØ­Øµ Ø£Ù…Ø§Ù† Node.js
    runs-on: ubuntu-latest
    
    steps:
      - name: ğŸ“¥ Ø§Ø³ØªÙ†Ø³Ø§Ø® Ø§Ù„ÙƒÙˆØ¯
        uses: actions/checkout@v4

      - name: âš™ï¸ Ø¥Ø¹Ø¯Ø§Ø¯ Ø¨ÙŠØ¦Ø© Node.js
        uses: actions/setup-node@v6.2.0
        with:
          node-version: 18
          cache: npm

      - name: ğŸ“¦ ØªØ«Ø¨ÙŠØª Ø§Ù„ØªØ¨Ø¹ÙŠØ§Øª
        run: npm install

      - name: âš”ï¸ ØªÙ†ÙÙŠØ° ÙØ­Øµ njsscan
        id: njsscan
        uses: ajinabraham/njsscan-action@7237412fdd36af517e2745077cedbf9d6900d711
        with:
          args: '. --sarif --output results.sarif || true'

      - name: ğŸ“¤ Ø±ÙØ¹ ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø£Ù…Ø§Ù†
        uses: github/codeql-action/upload-sarif@v3
        with:
          sarif_file: results.sarif
