name: ğŸ”’ Node.js Security Scan

on:
  push:
    branches: ["main"]
  pull_request:
    branches: ["main"]
  schedule:
    - cron: '0 2 * * 1'  # ÙƒÙ„ Ø¥Ø«Ù†ÙŠÙ† Ø§Ù„Ø³Ø§Ø¹Ø© 2 ØµØ¨Ø§Ø­Ø§Ù‹

permissions:
  contents: read
  security-events: write
  actions: read

jobs:
  security-scan:
    name: ğŸ›¡ï¸ ÙØ­Øµ Ø§Ù„Ø«ØºØ±Ø§Øª Ø§Ù„Ø£Ù…Ù†ÙŠØ©
    runs-on: ubuntu-latest
    
    steps:
      - name: ğŸ“¥ Ø§Ø³ØªÙ†Ø³Ø§Ø® Ø§Ù„ÙƒÙˆØ¯
        uses: actions/checkout@v4

      - name: âš”ï¸ ØªÙ†ÙÙŠØ° ÙØ­Øµ njsscan
        id: njsscan
        uses: ajinabraham/njsscan-action@7237412fdd36af517e2745077cedbf9d6900d711
        with:
          args: '. --sarif --output results.sarif || true'

      - name: ğŸ“¤ Ø±ÙØ¹ ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø£Ù…Ø§Ù†
        uses: github/codeql-action/upload-sarif@v3
        with:
          sarif_file: results.sarif
